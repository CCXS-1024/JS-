# 前段性能优化总结

### 1. 减少HTTP请求次数和传输报文的大小

- 使用雪碧图
- 使用字体图标和SVG等矢量图
  - 减少HTTP请求的次数或者减少请求的内容大小
  - 渲染更快：因为他们是基于代码渲染的，二位图（png/jpg/gif)是需要把图片编码再渲染
  - 不容易失真变形
  - 也可以使用webp格式图片，这种格式要小点（但是需要服务器支持这种格式的请求处理）
  - 第一次加载页面的时候不去请求真实的图片，提高第
    一次渲染页面的速度
  - 当页面加载完，把出现在用户视野区域中的图片做真实加载，没有出现的先不加载（节约流量，也能减少对服务器的请求压力）
- 图片懒加载（延迟加载）技术
  - 第一次加载页面的时候不去请求真实的图片，提高第一次渲染页面的速度
  - 当页面加载完，把出现在用户视野区域的图片做真实加载，没有出现的先不加载（节约流量，也能减少服务器的请求压力）
- 音频文件取消预加载（），这样可以增加第一次渲染页面的速度，当需要播放的时候再加载
- 客户端和服务器端的传输应该多用JSON 格式
- 把页面中的css/JS合并并压缩
  - 合并：争取CSS和JS只导入一个（webpack可以制动实现压缩）
  - 压缩：基于webpack可以压缩，对于图片自己可以找工具压缩，还可以使用服务器的GZIO压缩
- 图片地图：对于多次调用使用的图片（尤其是背景图），我们尽可能的把它提取称为公共的样式，而不是每一次重新设置background
- 图片 BEAS64（用BASE64代表图片，减少HTTP请求，增加浏览器的渲染速度）

### 2.设置各种缓存，处理长连接机制

- 把不经常的静态页面做缓存处理（304或者ETAG等协商缓存）
- DNS缓存或者预处理，减少DNS缓存
- 设置本地的离线储存（manifest）或者把一些不经常更改的数据做本地存储（websrotage,indexdb）等
- 做CDN（地域分布服务器）和加服务器
- 建立Connection：keep-alive RCP长链接
- 建立Cache-Control 和 expires HTTP强缓存
- 使用HTTP2协议
  - 可以多条TCP通道共存=》管道化链接
- 一个项日分为不同的域（不同的服务器），例如：资源WEB服务器、数据服务器、图片服务器、视频服务器等，这样合理利用服务器资源，但是导致过多的DNS解析

### 3. 代码方面的优化

- 减少闭包的使用（因为过多使用闭包会产生很多不销毁的内存，处理不好的话，会导致内存溢出“栈溢出”）
- 能用css解决的不用JS（能够用transform处理的不用传统的css样式，因为transform可以开启硬件加速，不会引发回流），能用requestAnimationFrame的不用定时器
  - requestAnimationFrame 当页面处于休眠状态，动画会自己暂停避免直到恢复才能开始访问）
- 减少对DOM的操作，当代项目基本基于mvvm/mvc数据驱动视图
- 低耦合高内聚 （对重复的代码进行封装）
- 使用事件委托
- 避免出现死循环和嵌套循环
- 在项目中多使用异步编程，避免主线程的堵塞
- 避免使用css表达式
- 函数的防抖和节流
- 减少filter滤镜的使用
- 尽可能减少选择器的层级**（选择器是从右向左解析）** .box a{} 和 a{}
- 减少table布局
- 手动回收堆栈内存



JS前段代码的108 建议

雅黑css代码的36条建议